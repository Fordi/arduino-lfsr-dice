# Dice Roller

This project is a demo using a modified linear feedback shift register and an analog pin to generate entropy for simulated dice rolling with low-predictability values.

It's an over-engineered random number generator.

# LFSR

This uses a Fibonacci-style linear feedback shift register with a couple of modifications to improve entropy:

* For every shift, there's a 1-in-8 chance that the register will use a different tap set
* For every 16 shifts, we read from an external source of entropy to flip the feedback bit
* We read _just_ the lowest bit from each shift to build out the number, and shift 16 times
   to produce an output word

Visualization of an lfsr with entropy.  This is tap 0x002D (0000000000101101b); the tap used changes from time to time.

* The tap is applied (generating a new bit)
* The state is shifted right by 1
* The tapped bit is placed in bit 15 (F below)

```
-----------------------------------------------------------------  -----
| F | E | D | C | B | A | 9 | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |>>|ent|
-----------------------------------------------------------------  -----
  ^                                       |       |   |       |      |              
  --------------xor---------------------------------------------------
                                                              |
                                                             out
```

# AnalogEntropySource

This is a simple thing that takes two reads off an analog pin and compares the lowest bit, resulting in a 1 if they're different and a 0 if not.

## taps.h

taps.h is generated by the `find_lfsr_taps` subproject, and defines the set of 16-bit taps the lfsr has available to it.  To regenerate `taps.h` yourself (it randomizes the taps' order, so you might want to), run:

```bash
make -C find_lfsr_taps 2>taps.h
```
